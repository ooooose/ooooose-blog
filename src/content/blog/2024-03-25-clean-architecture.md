---
author: おーせ
pubDatetime: 2024-03-25
title: LaravelにおけるDDD体験の備忘録
slug: laravel-clean-architecture
featured: true
draft: true
tags:
  - クリーンアーキテクチャ
  - Laravel
description:
  Laravel/Vueの実装においてDDDに則った実装を体験したので、その備忘録です。
---

## はじめに
今携わっている案件でLaravelにおけるクリーンアーキテクチャを勉強する必要があったので、その備忘録として学んだことを残します。

## なぜアーキテクチャが必要なのか
アーキテクチャについてかなりこだわる人が多く駆け出しの私はそれが不思議でした。<br />
しかし、今の受託案件では先方がどういったアーキテクチャを選定するかを求めてくることもあるとか、さすがになぜ必要かは認識しておかないとエンジニアとしてまずいと思いました。<br />
自分で調べた限り、クリーンアーキテクチャのメリットには共通して**可読性・保守性**といったワードが多かったです。<br />
責務の切り分けを一定のルールに乗っ取り行うことで**クラスやメソッド単位の役割が明確**になる。<br />
そういう積み重ねを丁寧にやっていけば、チームに誰かがジョインしたタイミングであっても、コードリーディングもしやすいため稼働が周りやすくなります。<br />
一昔前までは、今のものに比べるとハードウェアのCPUやメモリ数が低く、以下にメモリを使用せずCPUを浪費しないコードを書くかに重きがおかれていたようです。<br />
これは今でも気にすべきことですが、現在においてはアプリを長く運用するために**保守性が高く堅牢なアプリケーションに対して需要が高い**ため、クリーンアーキテクチャに対する知見が求められるのだと思います。

## アーキテクチャについて
アーキテクチャの名称云々は分かりませんが、以下4層の構成となっています。<br />
- Controller
- Usecase
- Service
- Repository
各層の役割についてそれぞれまとめていきます。
### Repository層
外部APIやエロクアントによるDB操作などをRepository層で行なっています。<br />
複雑なロジックは書かないことを心がけ、何をする実装かを明確にした上で実装しました。<br />
例えば、TaskといったモデルのRepository層でuseIdにひもづくレコードを取得する実装は以下のようになります。<br />

```php
// クラスやuseは省略しています

public function fetchTask(): Task
{
    return  
}

```
また、Taskモデルの1レコードを削除する実装は以下のようになります。
```php

```
実務の中で以下の2点を注意されました。<br />
- 返り値は必ず何かを指定すること
- 誰がみてもわかる名称にすること
一つ目は、storeメソッドなどでも可能な限り

### Service層
### Usecase層


### Controller層
フロントからRequestを受け取りUsecaseに渡した結果の返り値をViewに返すという処理に終始しています。<br />
受け取って返すという処理に留めておくことを心がけていますが、viewに返す変数の整形は行なっています。<br />
本来これは`ViewModel`を使って整形すべきかもしれませんが、実装上の負担と天秤にかけつつ複雑な処理にならなければ、コントローラで実装しています。
