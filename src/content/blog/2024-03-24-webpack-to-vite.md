---
author: おーせ
pubDatetime: 2024-03-24
title: webpackからviteに乗り換え奮闘記(Laravel・Vite)
slug: webpack-to-vite
featured: true
draft: false
# ogImage: https://user-images.githubusercontent.com/53733092/215771435-25408246-2309-4f8b-a781-1f3d93bdf0ec.png
tags:
  - Laravel
  - Vite
description: Laravel・Vueの案件でwebpackからviteに乗り換えたので、その奮闘記を書き記します。
---

## はじめに
以下のとおりプロジェクトで使用しているライブラリをアップデートを行いましたので、その備忘録を記録します。<br />
特にwebpackからviteへは苦戦したので詳細に記載したいと思います。

| ライブラリ                | 旧           | 新                 |
| ----------------------- | ------------ | ------------------ |
| PHP                     | 8.1          | 8.3.3              |
| composer                | 2.5          | 2.7.1              |
| Vue                     | 2.x          | 3.x                |
| CSS budler              | Webpack      | Vite               |


## PHPのバージョンアップをした理由
単純に運用しているアプリで使用しているPHPのバージョン、それに付随するライブラリのバージョンが古くなったため、という理由もありました。
が、今回PHPのバージョンを上げた理由はPHP`8.2`からリリースされた`[\SensitivePrameter]`という機能を使いたいという明確な理由がありました。
### `SensitivePrameter`とは
詳しくは[リリースノート]()を見ていただければと思いますが、簡単に言いますとメソッドに渡した引数を秘匿するといった役割を果たします。
例えば以下のような実装があるとします。
```php

```
この実装について、`$hoge`という引数に対して`SensitiveParamer`を付与するとスタックトレースで以下のように出力されます。
```zsh

```
AWSなどのクラウドサービスを利用している場合だと`CloudFront`に出力されるログなどで出力したくない引数の内訳、例えばパスワードやメールアドレスなど秘匿情報を表示させたくないケースがあると思います。
今回はクライアントから運用上そのような要望がありましたので、SensitiveParamerを使用できるPHP8.2以上であり、かつ当時安定版の最新版だった`PHP8.3.3`を選定してアップグレードしました。

### 対応したこと
こちらはDockerfileのPHPのバージョンを`8.3.3`に変更しただけです。元々が`8.1`だったので記述に大幅な変更はなかったです。<br />
強いて言えば、DockerImageの選定に時間がかかったというか。こちらもDockerHub公式の情報からセキュリティ脆弱性が低く、かつ案件で使用しているOSのイメージを採用しました。<br />
合わせてcomposerも`2.5`だったので、こちらも最新版の`2.7.1`に変更しましたが、その他に特段修正していません。<br />

## Vueのバージョンアップ(2.x -> 3.x)
PHP8系ではVue2系のサポートが終了した（要確認）ため、こちらもVue3にアップデートする必要がありました。<br />
ただ、こちらも当初案件はVue3で実装していましたが、クライアントが使用するOSではうまく機能せずVue2系にダウングレードした経緯がありました。<br />
なので、当初Vue3系で記載されていた内容ではあったので、Vue2からVue3にアップデートしたことで抜本的な修正は必要なかったです。<br />
強いていうなら、CompositionsAPIを使用していたので別途`@compositionsApi`のライブラリをインストールしていたのですが、Vue3からデフォルトで設定されているのでライブラリのインポート先が変わるなどありました。<br />
それぞれCompositionsAPIを呼び出している箇所を以下のように修正しました。<br />

```javascript

```